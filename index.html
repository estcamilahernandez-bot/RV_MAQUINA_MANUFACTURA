<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=5" />
  <title>Celda de Manufactura — A-Frame</title>

  <!-- A-Frame recomendado (CDN alterno por bloqueos de la uni) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/aframe/1.7.0/aframe.min.js"></script>

  <style>
    html,body{height:100%;margin:0}
  </style>

  <!-- Componente: baja el modelo hasta apoyar su base en el piso (y=0) -->
  <script>
    AFRAME.registerComponent('drop-to-ground', {
      init: function () {
        this.el.addEventListener('model-loaded', () => {
          const mesh = this.el.getObject3D('mesh');
          if (!mesh) return;
          mesh.updateMatrixWorld(true);
          const box = new THREE.Box3().setFromObject(mesh);
          const minY = box.min.y;
          // mueve la entidad para que la base quede en y=0
          this.el.object3D.position.y -= minY;
          // centrar en X/Z (descomenta si lo quieres)
          const center = box.getCenter(new THREE.Vector3());
          this.el.object3D.position.x -= center.x;
          this.el.object3D.position.z -= center.z;
        });
      }
    });
  </script>
</head>
<body>
  <a-scene
    background="color:#EDEDED"
    renderer="colorManagement: true; physicallyCorrectLights: true"
    xr-mode-ui="enabled: true"
    shadow="type:pcfsoft">

    <!-- Assets: asegúrate de que el nombre coincide exactamente (maquina.glb) -->
    <a-assets timeout="40000">
      <a-asset-item id="celda" src="atlantic_explorer_submarineglb (1).glb"></a-asset-item>
    </a-assets>

    <!-- Luces: tono cálido principal + relleno frío para contraste -->
    <a-entity light="type: hemisphere; color: #ffffff; groundColor: #bdbdbd; intensity: 0.9" position="0 5 0"></a-entity>
    <a-entity light="type: directional; color: #ffffff; intensity: 1; castShadow: true" position="4 8 6"></a-entity>
    <a-entity light="type: point; color: #aaddff; intensity: 0.4" position="-3 2 -3"></a-entity>

    <!-- Piso (y=0). rotación corregida -->
    <a-plane rotation="-90 0 0" width="14" height="14" color="#cfcfcf"
             material="metalness:0; roughness:1" shadow="receive: true"></a-plane>

    <!-- Modelo GLB: uniforme, drop-to-ground para apoyarlo automáticamente -->
    <a-entity id="modelo"
              gltf-model="#celda"
              scale="1 1 1"
              drop-to-ground
              shadow="cast: true; receive: true">
    </a-entity>

    <!-- Cámara / rig -->
    <a-entity id="rig" position="0 4 1">
      <a-camera wasd-controls="acceleration: 20" look-controls="pointerLockEnabled: true"></a-camera>
    </a-entity>

  </a-scene>
</body>
</html>









